# WebServer Frontend Makefile

FRONTEND_DIR = frontend
DIST_DIR = $(FRONTEND_DIR)/dist
NODE_MODULES = $(FRONTEND_DIR)/node_modules

.PHONY: all build install dev clean help

# é»˜è®¤ç›®æ ‡
all: build

# æ„å»ºå‰ç«¯ dist èµ„æº
build: install
	@echo "ğŸ”¨ æ„å»ºå‰ç«¯..."
	cd $(FRONTEND_DIR) && npm run build
	@echo "âœ… å‰ç«¯æ„å»ºå®Œæˆ: $(DIST_DIR)"

# å®‰è£…ä¾èµ–
install:
	@if [ ! -d "$(NODE_MODULES)" ]; then \
		echo "ğŸ“¥ å®‰è£…å‰ç«¯ä¾èµ–..."; \
		cd $(FRONTEND_DIR) && npm install; \
	else \
		echo "âœ… ä¾èµ–å·²å­˜åœ¨"; \
	fi

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
dev: install
	@echo "ğŸš€ å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨..."
	cd $(FRONTEND_DIR) && npm run dev

# é¢„è§ˆç”Ÿäº§æ„å»º
preview: build
	@echo "ğŸ‘€ é¢„è§ˆç”Ÿäº§æ„å»º..."
	cd $(FRONTEND_DIR) && npm run preview

# æ¸…ç†æ„å»ºäº§ç‰©
clean:
	@echo "ğŸ§¹ æ¸…ç†æ„å»ºäº§ç‰©..."
	rm -rf $(DIST_DIR)
	@echo "âœ… æ¸…ç†å®Œæˆ"

# å®Œå…¨æ¸…ç†ï¼ˆåŒ…æ‹¬ä¾èµ–ï¼‰
distclean: clean
	@echo "ğŸ§¹ æ¸…ç†ä¾èµ–..."
	rm -rf $(NODE_MODULES)
	@echo "âœ… å®Œå…¨æ¸…ç†å®Œæˆ"

# å¸®åŠ©ä¿¡æ¯
help:
	@echo "WebServer Frontend Makefile"
	@echo ""
	@echo "å¯ç”¨ç›®æ ‡ï¼š"
	@echo "  make build      - æ„å»ºå‰ç«¯ dist èµ„æº"
	@echo "  make install    - å®‰è£…å‰ç«¯ä¾èµ–"
	@echo "  make dev        - å¯åŠ¨å¼€å‘æœåŠ¡å™¨"
	@echo "  make preview    - é¢„è§ˆç”Ÿäº§æ„å»º"
	@echo "  make clean      - æ¸…ç†æ„å»ºäº§ç‰©"
	@echo "  make distclean  - å®Œå…¨æ¸…ç†ï¼ˆåŒ…æ‹¬ä¾èµ–ï¼‰"
	@echo "  make help       - æ˜¾ç¤ºæ­¤å¸®åŠ©ä¿¡æ¯"
